
> cocov@3.3.6 test:coverage
> vitest run --coverage


 RUN  v1.6.1 /Users/lg/lab/cocov
      Coverage enabled with v8

 ‚úì src/markdown-generator.test.ts  (6 tests) 2ms
 ‚úì src/core/badges/generator.test.ts  (14 tests) 3ms
stdout | src/stack-guard.test.ts > StackGuard > check > passes when requirements met
Running Stack Guard...
‚úî Stack Check Passed

stdout | src/stack-guard.test.ts > StackGuard > check > fails when required dep missing
Running Stack Guard...

stdout | src/stack-guard.test.ts > StackGuard > check > fails when forbidden dep present
Running Stack Guard...

stdout | src/stack-guard.test.ts > StackGuard > check > passes if no stack config
Running Stack Guard...
‚úî Stack Check Passed

stdout | src/stack-guard.test.ts > StackGuard > check > warns if tsconfig missing
Running Stack Guard...
‚úî Stack Check Passed

stdout | src/stack-guard.test.ts > StackGuard > check > fails if package.json missing
Running Stack Guard...

 ‚úì src/git-utils.test.ts  (8 tests) 5ms
 ‚úì src/stack-guard.test.ts  (6 tests) 9ms
stdout | src/commands/badge.test.ts > badgeAction > generates lines badge by default
‚úî Badge generated: cocov-badge-lines.svg

stdout | src/commands/badge.test.ts > badgeAction > generates specific badge type
‚úî Badge generated: cocov-badge-branches.svg

stdout | src/commands/badge.test.ts > badgeAction > generates unified badge
‚úî Unified Badge generated: cocov-badge-unified.svg

stdout | src/commands/badge.test.ts > badgeAction > generates diff badge
‚úî Diff Badge generated: cocov-badge-diff-lines.svg

stdout | src/commands/badge.test.ts > badgeAction > generates diff badge with no baseline (warns)
‚úî Diff Badge generated: cocov-badge-diff-lines.svg

stdout | src/commands/badge.test.ts > badgeAction > generates all badges
‚úî Badge generated: cocov-badge-lines.svg
‚úî Badge generated: cocov-badge-statements.svg
‚úî Badge generated: cocov-badge-functions.svg
‚úî Badge generated: cocov-badge-branches.svg
‚úî Badge generated: cocov-badge-unified.svg
‚úî Badge generated: cocov-badge-diff-lines.svg
‚úî Badge generated: cocov-badge-diff-statements.svg
‚úî Badge generated: cocov-badge-diff-functions.svg
‚úî Badge generated: cocov-badge-diff-branches.svg

stdout | src/commands/badge.test.ts > badgeAction > handles output option for single badge
‚úî Badge generated: custom.svg

stdout | src/commands/badge.test.ts > badgeAction > handles output option for unified badge
‚úî Unified Badge generated: custom-u.svg

stdout | src/commands/badge.test.ts > badgeAction > handles output option for all badges (prefix)
‚úî Badge generated: custom-lines.svg
‚úî Badge generated: custom-statements.svg
‚úî Badge generated: custom-functions.svg
‚úî Badge generated: custom-branches.svg
‚úî Badge generated: custom-unified.svg
‚úî Badge generated: custom-diff-lines.svg
‚úî Badge generated: custom-diff-statements.svg
‚úî Badge generated: custom-diff-functions.svg
‚úî Badge generated: custom-diff-branches.svg

stdout | src/commands/badge.test.ts > badgeAction > generates logo badge
‚úî Badge generated: cocov-badge-logo.svg

stdout | src/commands/badge.test.ts > badgeAction > defaults to lines for unknown type
‚úî Badge generated: cocov-badge-unknown.svg

 ‚úì src/commands/badge.test.ts  (12 tests) 10ms
stdout | src/cli.test.ts > cli > creates program with correct name and version
     .....:--:.....     
   .:.:::------:::.:.   
 .:-:::---------.::.-:. 
.-==:.::..::::..:..:==-.
.:-=+*+::::::::::+*++=:.
    ...:   ..  ::...    
        ...:....        
        .-----:.        
      .....::----:      
     ..::---------.     
   ..........:------.   
    ....::---------..   


üöÄ Welcome to Cocov: The Code Coverage Gate


stdout | src/core/init/scaffold.test.ts > scaffoldConfig > creates .cocov/config.json

‚úî Created /cwd/.cocov/config.json

stdout | src/core/init/scaffold.test.ts > scaffoldConfig > creates .cocov/config.json without stack if disabled

‚úî Created /cwd/.cocov/config.json

stdout | src/core/init/scaffold.test.ts > scaffoldConfig > appends coverage flags for vitest

‚úî Created /cwd/.cocov/config.json

stdout | src/core/init/scaffold.test.ts > setupHusky > installs and inits husky
Installing Husky...
‚úî Created hardened pre-commit hook

stdout | src/core/init/scaffold.test.ts > setupHusky > configures pre-push hook
Installing Husky...
‚úî Created hardened pre-push hook

stdout | src/core/init/scaffold.test.ts > setupHusky > handles errors gracefully
Installing Husky...

stdout | src/core/init/scaffold.test.ts > setupHusky > handles non-Error exceptions
Installing Husky...

stdout | src/core/init/scaffold.test.ts > setupHusky > skips unknown hooks
Installing Husky...

stdout | src/core/init/scaffold.test.ts > setupHusky > appends to hook if it exists but missing cocov
Installing Husky...
‚úî Injected Cocov Guard into pre-commit

stdout | src/core/init/scaffold.test.ts > setupGithub > creates workflow file

‚úî Created GitHub Action at /cwd/.github/workflows/cocov.yml

stdout | src/core/init/scaffold.test.ts > updateGitIgnore > creates .gitignore if missing
‚úî Created .gitignore with .cocov

stdout | src/core/init/scaffold.test.ts > updateGitIgnore > appends to .gitignore if exists but missing entry
‚úî Added .cocov to .gitignore

stdout | src/core/init/scaffold.test.ts > updateGitIgnore > skips appending if entry already exists
‚Ñπ .cocov already in .gitignore

stdout | src/core/init/scaffold.test.ts > setupGithub idempotency > skips if workflow already exists
GitHub Action already exists. Skipping.

stdout | src/cli.test.ts > cli > triggers init command
     .....:--:.....     
   .:.:::------:::.:.   
 .:-:::---------.::.-:. 
.-==:.::..::::..:..:==-.
.:-=+*+::::::::::+*++=:.
    ...:   ..  ::...    
        ...:....        
        .-----:.        
      .....::----:      
     ..::---------.     
   ..........:------.   
    ....::---------..   


üöÄ Welcome to Cocov: The Code Coverage Gate


stdout | src/cli.test.ts > cli > triggers run command
     .....:--:.....     
   .:.:::------:::.:.   
 .:-:::---------.::.-:. 
.-==:.::..::::..:..:==-.
.:-=+*+::::::::::+*++=:.
    ...:   ..  ::...    
        ...:....        
        .-----:.        
      .....::----:      
     ..::---------.     
   ..........:------.   
    ....::---------..   


üöÄ Welcome to Cocov: The Code Coverage Gate


stdout | src/cli.test.ts > cli > triggers html command
     .....:--:.....     
   .:.:::------:::.:.   
 .:-:::---------.::.-:. 
.-==:.::..::::..:..:==-.
.:-=+*+::::::::::+*++=:.
    ...:   ..  ::...    
        ...:....        
        .-----:.        
      .....::----:      
     ..::---------.     
   ..........:------.   
    ....::---------..   


üöÄ Welcome to Cocov: The Code Coverage Gate


 ‚úì src/core/init/scaffold.test.ts  (19 tests) 17ms
stdout | src/cli.test.ts > cli > triggers badge command
     .....:--:.....     
   .:.:::------:::.:.   
 .:-:::---------.::.-:. 
.-==:.::..::::..:..:==-.
.:-=+*+::::::::::+*++=:.
    ...:   ..  ::...    
        ...:....        
        .-----:.        
      .....::----:      
     ..::---------.     
   ..........:------.   
    ....::---------..   


üöÄ Welcome to Cocov: The Code Coverage Gate


stdout | src/cli.test.ts > cli > triggers inject-readme command
     .....:--:.....     
   .:.:::------:::.:.   
 .:-:::---------.::.-:. 
.-==:.::..::::..:..:==-.
.:-=+*+::::::::::+*++=:.
    ...:   ..  ::...    
        ...:....        
        .-----:.        
      .....::----:      
     ..::---------.     
   ..........:------.   
    ....::---------..   


üöÄ Welcome to Cocov: The Code Coverage Gate


 ‚úì src/core/coverage/io.test.ts  (10 tests) 14ms
stdout | src/cli.test.ts > cli > handles init failure
     .....:--:.....     
   .:.:::------:::.:.   
 .:-:::---------.::.-:. 
.-==:.::..::::..:..:==-.
.:-=+*+::::::::::+*++=:.
    ...:   ..  ::...    
        ...:....        
        .-----:.        
      .....::----:      
     ..::---------.     
   ..........:------.   
    ....::---------..   


üöÄ Welcome to Cocov: The Code Coverage Gate


stdout | src/cli.test.ts > cli > handles unknown init errors
     .....:--:.....     
   .:.:::------:::.:.   
 .:-:::---------.::.-:. 
.-==:.::..::::..:..:==-.
.:-=+*+::::::::::+*++=:.
    ...:   ..  ::...    
        ...:....        
        .-----:.        
      .....::----:      
     ..::---------.     
   ..........:------.   
    ....::---------..   


üöÄ Welcome to Cocov: The Code Coverage Gate


 ‚úì src/cli.test.ts  (8 tests) 30ms
 ‚úì src/commands/inject-readme.test.ts  (6 tests) 11ms
stdout | src/core/logic/baseline-handler.test.ts > handleBaselineCheck > writes baseline if none exists (not dry run)
No baseline found. Saving current coverage as baseline.

stdout | src/core/logic/baseline-handler.test.ts > handleBaselineCheck > does not write baseline if none exists (dry run)
No baseline found. (Dry Run: Not saving).

stdout | src/core/logic/baseline-handler.test.ts > handleBaselineCheck > exits on regression

Coverage unchanged.

stdout | src/core/logic/baseline-handler.test.ts > handleBaselineCheck > updates baseline on improvement

‚úî Coverage improved! Updating baseline.

stdout | src/core/logic/baseline-handler.test.ts > handleBaselineCheck > does not update baseline on improvement (dry run)

‚úî Coverage improved! (Dry Run: Baseline NOT updated).

 ‚úì src/core/logic/baseline-handler.test.ts  (6 tests) 11ms
stdout | src/commands/run.test.ts > runAction > runs test command and handles baseline
Running test command: npm test...

stdout | src/commands/run.test.ts > runAction > enforces stack guard if enabled
Running test command: npm test...

stdout | src/commands/run.test.ts > runAction > runs diff check if enabled
Running test command: npm test...

stdout | src/commands/run.test.ts > runAction > handles dry run
Running test command: npm test...
üöß DRY RUN MODE: No baseline updates.

stdout | src/commands/run.test.ts > runAction > handles errors gracefully
Running test command: npm test...

stdout | src/commands/run.test.ts > runAction > handles unknown errors
Running test command: npm test...

stdout | src/commands/run.test.ts > runAction > handles ThresholdError
Running test command: npm test...

 ‚úì src/commands/run.test.ts  (7 tests) 11ms
 ‚úì src/core/logic/threshold-coverage.test.ts  (4 tests) 1ms
 ‚úì src/core/logic/diff-parser.spec.ts  (20 tests) 5ms
stdout | src/commands/markdown.test.ts > markdownAction > generates markdown file
‚úî Markdown report generated at .cocov/reports/summary.md

stdout | src/commands/markdown.test.ts > markdownAction > injects into README when option provided
‚úî Injected report into README.md

stdout | src/commands/markdown.test.ts > markdownAction > logs warning if injection fails
‚ö† Could not find injection markers in README.md
  Add <!-- cocov-start --> and <!-- cocov-end --> to your file.

 ‚úì src/commands/markdown.test.ts  (4 tests) 8ms
 ‚úì src/core/logic/diff-checker.test.ts  (4 tests) 8ms
 ‚úì src/history.test.ts  (4 tests) 7ms
stdout | src/core/init/questions.test.ts > askInitQuestions > prompts for overwrite if config exists
Running questions test case 1
DEBUG: askInitQuestions executing

stdout | src/core/init/questions.test.ts > askInitQuestions > skips prompts if config does not exist
Running questions test case 2
DEBUG: askInitQuestions executing

stdout | src/core/init/questions.test.ts > askInitQuestions > validates prompt definitions
DEBUG: askInitQuestions executing

 ‚úì src/core/init/questions.test.ts  (3 tests) 5ms
 ‚úì src/utils/banner.test.ts  (3 tests) 9ms
stdout | src/commands/debug-html.test.ts > Debug HTML > runs html action
Running HTML Action...
‚úî HTML report generated at .cocov/reports/index.html
Done HTML Action

 ‚úì src/reporter.test.ts  (2 tests) 10ms
 ‚úì src/commands/debug-html.test.ts  (2 tests) 3ms
 ‚úì src/core/logic/comparator.spec.ts  (400 tests) 85ms
stdout | src/commands/init.test.ts > runInit > runs full init workflow

                      --::=-                       
                 ::-==:::::-==::                   
               :::===::::::::===:::                
             :::-===:::::::::-===:::               
             .......=========-......:              
                  .:=   ==  ==:                    
                      .::===                       
                     ::::::--                      
                  ----:::::::::                    
                 ===========-::::                  
                =======-:::::::::                  
                  =: :::::::::::                   
  

üöÄ Welcome to Cocov: The Code Coverage Gate


      ‚ú® Cocov Configuration Complete! ‚ú®
  

  Next Steps:
  
  1. Review your configuration:
     cat .cocov/config.json

  2. Run your first coverage check:
     npx cocov run

  3. (Optional) Visualize your coverage history:
     npx cocov history

  For more documentation, visit:
  https://github.com/lguibr/cocov
  

       _..._
     .'     '.
    /  _   _  \
    | (o)_(o) |
    |   (_)   |   Protection Active!
    /    _    \
   /    | |    \
  (____/   \____)
  

stdout | src/commands/init.test.ts > runInit > skips if overwrite denied

                      --::=-                       
                 ::-==:::::-==::                   
               :::===::::::::===:::                
             :::-===:::::::::-===:::               
             .......=========-......:              
                  .:=   ==  ==:                    
                      .::===                       
                     ::::::--                      
                  ----:::::::::                    
                 ===========-::::                  
                =======-:::::::::                  
                  =: :::::::::::                   
  

üöÄ Welcome to Cocov: The Code Coverage Gate

Skipping configuration setup.

stdout | src/commands/init.test.ts > runInit > aborts on cancellation

                      --::=-                       
                 ::-==:::::-==::                   
               :::===::::::::===:::                
             :::-===:::::::::-===:::               
             .......=========-......:              
                  .:=   ==  ==:                    
                      .::===                       
                     ::::::--                      
                  ----:::::::::                    
                 ===========-::::                  
                =======-:::::::::                  
                  =: :::::::::::                   
  

üöÄ Welcome to Cocov: The Code Coverage Gate


 ‚úì src/commands/init.test.ts  (3 tests) 4ms
 ‚úì src/core/logic/threshold-validator.test.ts  (3 tests) 4ms
 ‚úì src/core/logic/threshold-gate.test.ts  (3 tests) 3ms
 ‚úì src/injector.test.ts  (3 tests) 3ms
 ‚úì src/core/integrity.test.ts  (4 tests) 7ms
stdout | src/core/logic/diff-runner.test.ts > runDiffCheck > skips if detailed coverage missing

üîç Running Diff-Aware Strict Mode...

stdout | src/core/logic/diff-runner.test.ts > runDiffCheck > passes if no diffs

üîç Running Diff-Aware Strict Mode...
‚úî Diff Strict Mode Passed: All changes covered.

stdout | src/core/logic/diff-runner.test.ts > runDiffCheck > exits if uncovered changes

üîç Running Diff-Aware Strict Mode...

 ‚úì src/core/logic/diff-runner.test.ts  (3 tests) 4ms
 ‚úì src/executor.test.ts  (2 tests) 6ms
 ‚úì src/core/html/generator.test.ts  (1 test) 3ms

 Test Files  29 passed (29)
      Tests  570 passed (570)
   Start at  14:03:19
   Duration  920ms (transform 736ms, setup 1ms, collect 2.20s, tests 298ms, environment 4ms, prepare 2.48s)

 % Coverage report from v8
-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
-------------------|---------|----------|---------|---------|-------------------
All files          |   99.71 |    96.55 |   98.36 |   99.71 |                   
 src               |   99.67 |      100 |     100 |   99.67 |                   
  cli.ts           |   97.77 |      100 |     100 |   97.77 | 64-65             
  comparator.ts    |     100 |      100 |     100 |     100 |                   
  diff-checker.ts  |     100 |      100 |     100 |     100 |                   
  executor.ts      |     100 |      100 |     100 |     100 |                   
  git-utils.ts     |     100 |      100 |     100 |     100 |                   
  history.ts       |     100 |      100 |     100 |     100 |                   
  injector.ts      |     100 |      100 |     100 |     100 |                   
  ...-generator.ts |     100 |      100 |     100 |     100 |                   
  reporter.ts      |     100 |      100 |     100 |     100 |                   
  stack-guard.ts   |     100 |      100 |     100 |     100 |                   
 src/commands      |   99.36 |    91.86 |     100 |   99.36 |                   
  badge.ts         |     100 |      100 |     100 |     100 |                   
  html.ts          |     100 |      100 |     100 |     100 |                   
  init.ts          |   97.29 |     64.7 |     100 |   97.29 | 101,109-110       
  inject-readme.ts |     100 |    92.85 |     100 |     100 | 83                
  markdown.ts      |     100 |      100 |     100 |     100 |                   
  run.ts           |     100 |      100 |     100 |     100 |                   
 src/core          |     100 |      100 |     100 |     100 |                   
  integrity.ts     |     100 |      100 |     100 |     100 |                   
 src/core/badges   |     100 |      100 |     100 |     100 |                   
  generator.ts     |     100 |      100 |     100 |     100 |                   
 src/core/coverage |     100 |      100 |     100 |     100 |                   
  reader.ts        |     100 |      100 |     100 |     100 |                   
  writer.ts        |     100 |      100 |     100 |     100 |                   
 src/core/html     |     100 |      100 |     100 |     100 |                   
  generator.ts     |     100 |      100 |     100 |     100 |                   
 ...html/templates |     100 |      100 |     100 |     100 |                   
  base.ts          |     100 |      100 |     100 |     100 |                   
 src/core/init     |   99.23 |    90.69 |    87.5 |   99.23 |                   
  questions.ts     |     100 |       80 |      75 |     100 | 49                
  scaffold.ts      |   98.71 |    93.93 |     100 |   98.71 | 18-19             
 src/core/logic    |     100 |      100 |     100 |     100 |                   
  ...ne-handler.ts |     100 |      100 |     100 |     100 |                   
  diff-runner.ts   |     100 |      100 |     100 |     100 |                   
  ...shold-gate.ts |     100 |      100 |     100 |     100 |                   
  ...-validator.ts |     100 |      100 |     100 |     100 |                   
 src/utils         |     100 |      100 |     100 |     100 |                   
  banner.ts        |     100 |      100 |     100 |     100 |                   
-------------------|---------|----------|---------|---------|-------------------
